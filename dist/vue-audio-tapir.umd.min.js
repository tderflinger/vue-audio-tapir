(function(t,e){"object"===typeof exports&&"object"===typeof module?module.exports=e(require("vue")):"function"===typeof define&&define.amd?define([],e):"object"===typeof exports?exports["vue-audio-tapir"]=e(require("vue")):t["vue-audio-tapir"]=e(t["Vue"])})("undefined"!==typeof self?self:this,(function(t){return function(){var e={9662:function(t,e,r){var n=r(7854),o=r(614),i=r(6330),s=n.TypeError;t.exports=function(t){if(o(t))return t;throw s(i(t)+" is not a function")}},6077:function(t,e,r){var n=r(7854),o=r(614),i=n.String,s=n.TypeError;t.exports=function(t){if("object"==typeof t||o(t))return t;throw s("Can't set "+i(t)+" as a prototype")}},9670:function(t,e,r){var n=r(7854),o=r(111),i=n.String,s=n.TypeError;t.exports=function(t){if(o(t))return t;throw s(i(t)+" is not an object")}},4019:function(t){t.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},260:function(t,e,r){"use strict";var n,o,i,s=r(4019),c=r(9781),a=r(7854),u=r(614),l=r(111),p=r(2597),f=r(648),d=r(6330),h=r(8880),v=r(1320),g=r(3070).f,m=r(7976),y=r(9518),b=r(7674),x=r(5112),w=r(9711),S=a.Int8Array,R=S&&S.prototype,A=a.Uint8ClampedArray,T=A&&A.prototype,M=S&&y(S),O=R&&y(R),_=Object.prototype,E=a.TypeError,j=x("toStringTag"),k=w("TYPED_ARRAY_TAG"),C=w("TYPED_ARRAY_CONSTRUCTOR"),B=s&&!!b&&"Opera"!==f(a.opera),z=!1,F={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},U={BigInt64Array:8,BigUint64Array:8},P=function(t){if(!l(t))return!1;var e=f(t);return"DataView"===e||p(F,e)||p(U,e)},V=function(t){if(!l(t))return!1;var e=f(t);return p(F,e)||p(U,e)},N=function(t){if(V(t))return t;throw E("Target is not a typed array")},D=function(t){if(u(t)&&(!b||m(M,t)))return t;throw E(d(t)+" is not a typed array constructor")},I=function(t,e,r){if(c){if(r)for(var n in F){var o=a[n];if(o&&p(o.prototype,t))try{delete o.prototype[t]}catch(i){}}O[t]&&!r||v(O,t,r?e:B&&R[t]||e)}},L=function(t,e,r){var n,o;if(c){if(b){if(r)for(n in F)if(o=a[n],o&&p(o,t))try{delete o[t]}catch(i){}if(M[t]&&!r)return;try{return v(M,t,r?e:B&&M[t]||e)}catch(i){}}for(n in F)o=a[n],!o||o[t]&&!r||v(o,t,e)}};for(n in F)o=a[n],i=o&&o.prototype,i?h(i,C,o):B=!1;for(n in U)o=a[n],i=o&&o.prototype,i&&h(i,C,o);if((!B||!u(M)||M===Function.prototype)&&(M=function(){throw E("Incorrect invocation")},B))for(n in F)a[n]&&b(a[n],M);if((!B||!O||O===_)&&(O=M.prototype,B))for(n in F)a[n]&&b(a[n].prototype,O);if(B&&y(T)!==O&&b(T,O),c&&!p(O,j))for(n in z=!0,g(O,j,{get:function(){return l(this)?this[k]:void 0}}),F)a[n]&&h(a[n],k,n);t.exports={NATIVE_ARRAY_BUFFER_VIEWS:B,TYPED_ARRAY_CONSTRUCTOR:C,TYPED_ARRAY_TAG:z&&k,aTypedArray:N,aTypedArrayConstructor:D,exportTypedArrayMethod:I,exportTypedArrayStaticMethod:L,isView:P,isTypedArray:V,TypedArray:M,TypedArrayPrototype:O}},9671:function(t,e,r){var n=r(9974),o=r(8361),i=r(7908),s=r(6244),c=function(t){var e=1==t;return function(r,c,a){var u,l,p=i(r),f=o(p),d=n(c,a),h=s(f);while(h-- >0)if(u=f[h],l=d(u,h,p),l)switch(t){case 0:return u;case 1:return h}return e?-1:void 0}};t.exports={findLast:c(0),findLastIndex:c(1)}},4326:function(t,e,r){var n=r(1702),o=n({}.toString),i=n("".slice);t.exports=function(t){return i(o(t),8,-1)}},648:function(t,e,r){var n=r(7854),o=r(1694),i=r(614),s=r(4326),c=r(5112),a=c("toStringTag"),u=n.Object,l="Arguments"==s(function(){return arguments}()),p=function(t,e){try{return t[e]}catch(r){}};t.exports=o?s:function(t){var e,r,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=p(e=u(t),a))?r:l?s(e):"Object"==(n=s(e))&&i(e.callee)?"Arguments":n}},9920:function(t,e,r){var n=r(7293);t.exports=!n((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},8880:function(t,e,r){var n=r(9781),o=r(3070),i=r(9114);t.exports=n?function(t,e,r){return o.f(t,e,i(1,r))}:function(t,e,r){return t[e]=r,t}},9114:function(t){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},9781:function(t,e,r){var n=r(7293);t.exports=!n((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},317:function(t,e,r){var n=r(7854),o=r(111),i=n.document,s=o(i)&&o(i.createElement);t.exports=function(t){return s?i.createElement(t):{}}},8113:function(t,e,r){var n=r(5005);t.exports=n("navigator","userAgent")||""},7392:function(t,e,r){var n,o,i=r(7854),s=r(8113),c=i.process,a=i.Deno,u=c&&c.versions||a&&a.version,l=u&&u.v8;l&&(n=l.split("."),o=n[0]>0&&n[0]<4?1:+(n[0]+n[1])),!o&&s&&(n=s.match(/Edge\/(\d+)/),(!n||n[1]>=74)&&(n=s.match(/Chrome\/(\d+)/),n&&(o=+n[1]))),t.exports=o},7293:function(t){t.exports=function(t){try{return!!t()}catch(e){return!0}}},9974:function(t,e,r){var n=r(1702),o=r(9662),i=n(n.bind);t.exports=function(t,e){return o(t),void 0===e?t:i?i(t,e):function(){return t.apply(e,arguments)}}},6916:function(t){var e=Function.prototype.call;t.exports=e.bind?e.bind(e):function(){return e.apply(e,arguments)}},6530:function(t,e,r){var n=r(9781),o=r(2597),i=Function.prototype,s=n&&Object.getOwnPropertyDescriptor,c=o(i,"name"),a=c&&"something"===function(){}.name,u=c&&(!n||n&&s(i,"name").configurable);t.exports={EXISTS:c,PROPER:a,CONFIGURABLE:u}},1702:function(t){var e=Function.prototype,r=e.bind,n=e.call,o=r&&r.bind(n);t.exports=r?function(t){return t&&o(n,t)}:function(t){return t&&function(){return n.apply(t,arguments)}}},5005:function(t,e,r){var n=r(7854),o=r(614),i=function(t){return o(t)?t:void 0};t.exports=function(t,e){return arguments.length<2?i(n[t]):n[t]&&n[t][e]}},8173:function(t,e,r){var n=r(9662);t.exports=function(t,e){var r=t[e];return null==r?void 0:n(r)}},7854:function(t,e,r){var n=function(t){return t&&t.Math==Math&&t};t.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof r.g&&r.g)||function(){return this}()||Function("return this")()},2597:function(t,e,r){var n=r(1702),o=r(7908),i=n({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,e){return i(o(t),e)}},3501:function(t){t.exports={}},4664:function(t,e,r){var n=r(9781),o=r(7293),i=r(317);t.exports=!n&&!o((function(){return 7!=Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a}))},8361:function(t,e,r){var n=r(7854),o=r(1702),i=r(7293),s=r(4326),c=n.Object,a=o("".split);t.exports=i((function(){return!c("z").propertyIsEnumerable(0)}))?function(t){return"String"==s(t)?a(t,""):c(t)}:c},2788:function(t,e,r){var n=r(1702),o=r(614),i=r(5465),s=n(Function.toString);o(i.inspectSource)||(i.inspectSource=function(t){return s(t)}),t.exports=i.inspectSource},9909:function(t,e,r){var n,o,i,s=r(8536),c=r(7854),a=r(1702),u=r(111),l=r(8880),p=r(2597),f=r(5465),d=r(6200),h=r(3501),v="Object already initialized",g=c.TypeError,m=c.WeakMap,y=function(t){return i(t)?o(t):n(t,{})},b=function(t){return function(e){var r;if(!u(e)||(r=o(e)).type!==t)throw g("Incompatible receiver, "+t+" required");return r}};if(s||f.state){var x=f.state||(f.state=new m),w=a(x.get),S=a(x.has),R=a(x.set);n=function(t,e){if(S(x,t))throw new g(v);return e.facade=t,R(x,t,e),e},o=function(t){return w(x,t)||{}},i=function(t){return S(x,t)}}else{var A=d("state");h[A]=!0,n=function(t,e){if(p(t,A))throw new g(v);return e.facade=t,l(t,A,e),e},o=function(t){return p(t,A)?t[A]:{}},i=function(t){return p(t,A)}}t.exports={set:n,get:o,has:i,enforce:y,getterFor:b}},614:function(t){t.exports=function(t){return"function"==typeof t}},111:function(t,e,r){var n=r(614);t.exports=function(t){return"object"==typeof t?null!==t:n(t)}},1913:function(t){t.exports=!1},2190:function(t,e,r){var n=r(7854),o=r(5005),i=r(614),s=r(7976),c=r(3307),a=n.Object;t.exports=c?function(t){return"symbol"==typeof t}:function(t){var e=o("Symbol");return i(e)&&s(e.prototype,a(t))}},6244:function(t,e,r){var n=r(7466);t.exports=function(t){return n(t.length)}},133:function(t,e,r){var n=r(7392),o=r(7293);t.exports=!!Object.getOwnPropertySymbols&&!o((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&n&&n<41}))},8536:function(t,e,r){var n=r(7854),o=r(614),i=r(2788),s=n.WeakMap;t.exports=o(s)&&/native code/.test(i(s))},3070:function(t,e,r){var n=r(7854),o=r(9781),i=r(4664),s=r(9670),c=r(4948),a=n.TypeError,u=Object.defineProperty;e.f=o?u:function(t,e,r){if(s(t),e=c(e),s(r),i)try{return u(t,e,r)}catch(n){}if("get"in r||"set"in r)throw a("Accessors not supported");return"value"in r&&(t[e]=r.value),t}},9518:function(t,e,r){var n=r(7854),o=r(2597),i=r(614),s=r(7908),c=r(6200),a=r(9920),u=c("IE_PROTO"),l=n.Object,p=l.prototype;t.exports=a?l.getPrototypeOf:function(t){var e=s(t);if(o(e,u))return e[u];var r=e.constructor;return i(r)&&e instanceof r?r.prototype:e instanceof l?p:null}},7976:function(t,e,r){var n=r(1702);t.exports=n({}.isPrototypeOf)},7674:function(t,e,r){var n=r(1702),o=r(9670),i=r(6077);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,r={};try{t=n(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set),t(r,[]),e=r instanceof Array}catch(s){}return function(r,n){return o(r),i(n),e?t(r,n):r.__proto__=n,r}}():void 0)},2140:function(t,e,r){var n=r(7854),o=r(6916),i=r(614),s=r(111),c=n.TypeError;t.exports=function(t,e){var r,n;if("string"===e&&i(r=t.toString)&&!s(n=o(r,t)))return n;if(i(r=t.valueOf)&&!s(n=o(r,t)))return n;if("string"!==e&&i(r=t.toString)&&!s(n=o(r,t)))return n;throw c("Can't convert object to primitive value")}},1320:function(t,e,r){var n=r(7854),o=r(614),i=r(2597),s=r(8880),c=r(3505),a=r(2788),u=r(9909),l=r(6530).CONFIGURABLE,p=u.get,f=u.enforce,d=String(String).split("String");(t.exports=function(t,e,r,a){var u,p=!!a&&!!a.unsafe,h=!!a&&!!a.enumerable,v=!!a&&!!a.noTargetGet,g=a&&void 0!==a.name?a.name:e;o(r)&&("Symbol("===String(g).slice(0,7)&&(g="["+String(g).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!i(r,"name")||l&&r.name!==g)&&s(r,"name",g),u=f(r),u.source||(u.source=d.join("string"==typeof g?g:""))),t!==n?(p?!v&&t[e]&&(h=!0):delete t[e],h?t[e]=r:s(t,e,r)):h?t[e]=r:c(e,r)})(Function.prototype,"toString",(function(){return o(this)&&p(this).source||a(this)}))},4488:function(t,e,r){var n=r(7854),o=n.TypeError;t.exports=function(t){if(void 0==t)throw o("Can't call method on "+t);return t}},3505:function(t,e,r){var n=r(7854),o=Object.defineProperty;t.exports=function(t,e){try{o(n,t,{value:e,configurable:!0,writable:!0})}catch(r){n[t]=e}return e}},6200:function(t,e,r){var n=r(2309),o=r(9711),i=n("keys");t.exports=function(t){return i[t]||(i[t]=o(t))}},5465:function(t,e,r){var n=r(7854),o=r(3505),i="__core-js_shared__",s=n[i]||o(i,{});t.exports=s},2309:function(t,e,r){var n=r(1913),o=r(5465);(t.exports=function(t,e){return o[t]||(o[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.19.1",mode:n?"pure":"global",copyright:"Â© 2021 Denis Pushkarev (zloirock.ru)"})},9303:function(t){var e=Math.ceil,r=Math.floor;t.exports=function(t){var n=+t;return n!==n||0===n?0:(n>0?r:e)(n)}},7466:function(t,e,r){var n=r(9303),o=Math.min;t.exports=function(t){return t>0?o(n(t),9007199254740991):0}},7908:function(t,e,r){var n=r(7854),o=r(4488),i=n.Object;t.exports=function(t){return i(o(t))}},7593:function(t,e,r){var n=r(7854),o=r(6916),i=r(111),s=r(2190),c=r(8173),a=r(2140),u=r(5112),l=n.TypeError,p=u("toPrimitive");t.exports=function(t,e){if(!i(t)||s(t))return t;var r,n=c(t,p);if(n){if(void 0===e&&(e="default"),r=o(n,t,e),!i(r)||s(r))return r;throw l("Can't convert object to primitive value")}return void 0===e&&(e="number"),a(t,e)}},4948:function(t,e,r){var n=r(7593),o=r(2190);t.exports=function(t){var e=n(t,"string");return o(e)?e:e+""}},1694:function(t,e,r){var n=r(5112),o=n("toStringTag"),i={};i[o]="z",t.exports="[object z]"===String(i)},6330:function(t,e,r){var n=r(7854),o=n.String;t.exports=function(t){try{return o(t)}catch(e){return"Object"}}},9711:function(t,e,r){var n=r(1702),o=0,i=Math.random(),s=n(1..toString);t.exports=function(t){return"Symbol("+(void 0===t?"":t)+")_"+s(++o+i,36)}},3307:function(t,e,r){var n=r(133);t.exports=n&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},5112:function(t,e,r){var n=r(7854),o=r(2309),i=r(2597),s=r(9711),c=r(133),a=r(3307),u=o("wks"),l=n.Symbol,p=l&&l["for"],f=a?l:l&&l.withoutSetter||s;t.exports=function(t){if(!i(u,t)||!c&&"string"!=typeof u[t]){var e="Symbol."+t;c&&i(l,t)?u[t]=l[t]:u[t]=a&&p?p(e):f(e)}return u[t]}},8675:function(t,e,r){"use strict";var n=r(260),o=r(6244),i=r(9303),s=n.aTypedArray,c=n.exportTypedArrayMethod;c("at",(function(t){var e=s(this),r=o(e),n=i(t),c=n>=0?n:r+n;return c<0||c>=r?void 0:e[c]}))},1118:function(t,e,r){"use strict";var n=r(260),o=r(9671).findLastIndex,i=n.aTypedArray,s=n.exportTypedArrayMethod;s("findLastIndex",(function(t){return o(i(this),t,arguments.length>1?arguments[1]:void 0)}))},7380:function(t,e,r){"use strict";var n=r(260),o=r(9671).findLast,i=n.aTypedArray,s=n.exportTypedArrayMethod;s("findLast",(function(t){return o(i(this),t,arguments.length>1?arguments[1]:void 0)}))},3744:function(t,e){"use strict";e.Z=(t,e)=>{const r=t.__vccOpts||t;for(const[n,o]of e)r[n]=o;return r}},7203:function(e){"use strict";e.exports=t}},r={};function n(t){var o=r[t];if(void 0!==o)return o.exports;var i=r[t]={exports:{}};return e[t](i,i.exports,n),i.exports}!function(){n.d=function(t,e){for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){n.p=""}();var o={};return function(){"use strict";if(n.d(o,{default:function(){return I}}),"undefined"!==typeof window){var t=window.document.currentScript,e=t&&t.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);e&&(n.p=e[1])}var r=n(7203);const i={class:"text-center font-sans w-96 mx-auto rounded-lg shadow-lg border-solid border-2 p-8"},s=(0,r.createElementVNode)("h2",{class:"font-bold text-2xl"},"Record Audio Message",-1),c={class:"text-sm font-bold"},a={class:"text-sm"},u={class:"text-sm text-red-400"},l={class:"mt-8"},p=["src"],f=(0,r.createTextVNode)(" Your browser does not support the "),d=(0,r.createElementVNode)("code",null,"audio",-1),h=(0,r.createTextVNode)(" element. "),v=[f,d,h],g=(0,r.createElementVNode)("figcaption",{class:"text-sm mt-2"},"Listen to your recording before submitting.",-1);function m(t,e,n,o,f,d){const h=(0,r.resolveComponent)("icon-button"),m=(0,r.resolveComponent)("submit-button");return(0,r.openBlock)(),(0,r.createElementBlock)("div",i,[s,(0,r.createElementVNode)("div",null,[f.recording?((0,r.openBlock)(),(0,r.createBlock)(h,{key:0,style:(0,r.normalizeStyle)({"border-color":n.buttonColor}),class:(0,r.normalizeClass)(d.buttonClass),name:"stop",onClick:d.toggleRecording},null,8,["style","class","onClick"])):((0,r.openBlock)(),(0,r.createBlock)(h,{key:1,style:(0,r.normalizeStyle)({"border-color":n.buttonColor}),class:(0,r.normalizeClass)(d.buttonClass),name:"mic",onClick:d.toggleRecording},null,8,["style","class","onClick"]))]),(0,r.createElementVNode)("div",null,(0,r.toDisplayString)(d.recordedTime),1),(0,r.createElementVNode)("div",c,(0,r.toDisplayString)(f.successMessage),1),(0,r.createElementVNode)("div",a,(0,r.toDisplayString)(f.instructionMessage),1),(0,r.createElementVNode)("div",u,(0,r.toDisplayString)(f.errorMessage),1),(0,r.createElementVNode)("figure",l,[(0,r.createElementVNode)("audio",{controls:"",src:f.recordedAudio,type:"audio/mpeg",class:"mx-auto"},v,8,p),g]),(0,r.createVNode)(m,{onSubmit:d.sendData,color:n.buttonColor},null,8,["onSubmit","color"])])}class y{constructor(t){this.backendEndpoint=t}async postBackend(t){try{const e=await fetch(this.backendEndpoint,{method:"POST",body:t});return!!e.ok}catch(e){return!1}}}n(8675),n(7380),n(1118);function b(t){return t?new Date(1e3*t).toISOString().substr(14,5):null}var x=class{constructor(t){this.bufferSize=t.bufferSize||4096,this.sampleRate=t.sampleRate,this.samples=t.samples}finish(){this._joinSamples();const t=new ArrayBuffer(44+2*this.samples.length),e=new DataView(t);this._writeString(e,0,"RIFF"),e.setUint32(4,36+2*this.samples.length,!0),this._writeString(e,8,"WAVE"),this._writeString(e,12,"fmt "),e.setUint32(16,16,!0),e.setUint16(20,1,!0),e.setUint16(22,1,!0),e.setUint32(24,this.sampleRate,!0),e.setUint32(28,4*this.sampleRate,!0),e.setUint16(32,4,!0),e.setUint16(34,16,!0),this._writeString(e,36,"data"),e.setUint32(40,2*this.samples.length,!0),this._floatTo16BitPCM(e,44,this.samples);const r=new Blob([e],{type:"audio/wav"});return{id:Date.now(),blob:r,url:URL.createObjectURL(r)}}_floatTo16BitPCM(t,e,r){for(let n=0;n<r.length;n++,e+=2){const o=Math.max(-1,Math.min(1,r[n]));t.setInt16(e,o<0?32768*o:32767*o,!0)}}_joinSamples(){const t=this.samples.length*this.bufferSize,e=new Float64Array(t);let r=0;for(let n=0;n<this.samples.length;n++){const t=this.samples[n];e.set(t,r),r+=t.length}this.samples=e}_writeString(t,e,r){for(let n=0;n<r.length;n++)t.setUint8(e+n,r.charCodeAt(n))}};class w{constructor(t={}){this.beforeRecording=t.beforeRecording,this.pauseRecording=t.pauseRecording,this.afterRecording=t.afterRecording,this.micFailed=t.micFailed,this.encoderOptions={bitRate:t.bitRate,sampleRate:t.sampleRate},this.bufferSize=4096,this.records=[],this.isPause=!1,this.isRecording=!1,this.duration=0,this.volume=0,this.wavSamples=[],this._duration=0}start(){const t={video:!1,audio:{channelCount:1,echoCancellation:!1}};this.beforeRecording&&this.beforeRecording("start recording"),navigator.mediaDevices.getUserMedia(t).then(this._micCaptured.bind(this)).catch(this._micError.bind(this)),this.isPause=!1,this.isRecording=!0}stop(){this.stream.getTracks().forEach((t=>t.stop())),this.input.disconnect(),this.processor.disconnect(),this.context.close();let t=null;const e=new x({bufferSize:this.bufferSize,sampleRate:this.encoderOptions.sampleRate,samples:this.wavSamples});t=e.finish(),this.wavSamples=[],t.duration=b(this.duration),this.records.push(t),this._duration=0,this.duration=0,this.isPause=!1,this.isRecording=!1,this.afterRecording&&this.afterRecording(t)}pause(){this.stream.getTracks().forEach((t=>t.stop())),this.input.disconnect(),this.processor.disconnect(),this._duration=this.duration,this.isPause=!0,this.pauseRecording&&this.pauseRecording("pause recording")}recordList(){return this.records}lastRecord(){return this.records.slice(-1).pop()}_micCaptured(t){this.context=new(window.AudioContext||window.webkitAudioContext),this.duration=this._duration,this.input=this.context.createMediaStreamSource(t),this.processor=this.context.createScriptProcessor(this.bufferSize,1,1),this.stream=t,this.processor.onaudioprocess=t=>{const e=t.inputBuffer.getChannelData(0);let r=0;this.wavSamples.push(new Float32Array(e));for(let n=0;n<e.length;++n)r+=e[n]*e[n];this.duration=parseFloat(this._duration)+parseFloat(this.context.currentTime.toFixed(2)),this.volume=Math.sqrt(r/e.length).toFixed(2)},this.input.connect(this.processor),this.processor.connect(this.context.destination)}_micError(t){this.micFailed&&this.micFailed(t)}}const S=["innerHTML"];function R(t,e,n,o,i,s){return(0,r.openBlock)(),(0,r.createElementBlock)("div",{innerHTML:i.icons[n.name]},null,8,S)}var A={props:{name:{type:String}},data(){return{icons:{download:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 12v7H5v-7H3v7c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zm-6 .67l2.59-2.58L17 11.5l-5 5-5-5 1.41-1.41L11 12.67V3h2z"/><path fill="none" d="M0 0h24v24H0z"/></svg>',mic:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 14c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.48 6-3.3 6-6.72h-1.7z"/><path d="M0 0h24v24H0z" fill="none"/></svg>',play:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/><path d="M0 0h24v24H0z" fill="none"/></svg>',save:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"/></svg>',stop:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M6 6h12v12H6z"/></svg>',volume:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/><path d="M0 0h24v24H0z" fill="none"/></svg>'}}}},T=n(3744);const M=(0,T.Z)(A,[["render",R]]);var O=M;function _(t,e,n,o,i,s){return(0,r.openBlock)(),(0,r.createElementBlock)("button",{onClick:e[0]||(e[0]=(...t)=>s.clickButton&&s.clickButton(...t)),style:(0,r.normalizeStyle)({"background-color":n.color}),class:"p-3 mt-8 text-black rounded-md"}," Submit ",4)}var E={emits:["submit"],props:{color:{type:String}},methods:{clickButton(){this.$emit("submit")}}};const j=(0,T.Z)(E,[["render",_]]);var k=j;const C="Click icon to start recording message.",B="Click icon again to stop recording.",z="Failed to use microphone. Please refresh and try again and permit the use of a microphone.",F="Successfully recorded message!",U="Successfully submitted audio message! Thank you!",P="Error submitting audio message! Please try again later.";var V={name:"TapirWidget",props:{time:{type:Number,default:1},bitRate:{type:Number,default:128},sampleRate:{type:Number,default:44100},backendEndpoint:{type:String},buttonColor:{type:String,default:"green"},afterRecording:{type:Function},successfulUpload:{type:Function},failedUpload:{type:Function},customUpload:{type:Function,default:null}},components:{IconButton:O,SubmitButton:k},data(){return{recording:!1,recordedAudio:null,recordedBlob:null,recorder:null,successMessage:null,errorMessage:null,instructionMessage:C}},computed:{buttonClass(){return"mx-auto h-14 w-14 fill-current text-black cursor-pointer rounded-50 border-2 m-4 p-2"},recordedTime(){return this.time&&this.recorder?.duration>=60*this.time&&this.toggleRecording(),b(this.recorder?.duration)}},beforeUnmount(){this.recording&&this.stopRecorder()},methods:{toggleRecording(){this.recording=!this.recording,this.recording?this.initRecorder():this.stopRecording()},initRecorder(){this.recorder=new w({micFailed:this.micFailed,bitRate:this.bitRate,sampleRate:this.sampleRate}),this.recorder.start(),this.successMessage=null,this.errorMessage=null,this.instructionMessage=B,this.service=new y(this.backendEndpoint)},stopRecording(){this.recorder.stop();const t=this.recorder.recordList();this.recordedAudio=t[0].url,this.recordedBlob=t[0].blob,this.recordedAudio&&(this.successMessage=F,this.instructionMessage=null),this.afterRecording&&this.afterRecording()},async sendData(){if(!this.recordedBlob)return;let t=null;t=this.customUpload?await this.customUpload(this.recordedBlob):await this.service.postBackend(this.recordedBlob),t?(this.errorMessage=null,this.successMessage=U,this.successfulUpload&&this.successfulUpload()):(this.successMessage=null,this.errorMessage=P,this.failedUpload&&this.failedUpload())},micFailed(){this.recording=!1,this.instructionMessage=C,this.errorMessage=z}}};const N=(0,T.Z)(V,[["render",m]]);var D=N,I=D}(),o=o["default"],o}()}));
//# sourceMappingURL=vue-audio-tapir.umd.min.js.map